{% extends 'base.html.twig' %}

{% block title %}Mon Espace - CampusFlow{% endblock %}

{% block body %}
<!-- Welcome Section -->
<div class="bg-gradient-to-r from-blue-600 to-blue-500 rounded-3xl p-8 text-white shadow-xl mb-8 relative overflow-hidden">
    <!-- Decorative Circles -->
    <div class="absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 rounded-full bg-white/10 blur-3xl"></div>
    <div class="absolute bottom-0 left-0 -ml-10 -mb-10 w-40 h-40 rounded-full bg-yellow-400/20 blur-2xl"></div>
    
    <div class="relative z-10 flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-extrabold mb-2">Bonjour, {{ student.firstName }} ! ðŸ‘‹</h1>
            <p class="text-blue-100 font-medium text-lg">PrÃªt pour une nouvelle journÃ©e d'apprentissage ?</p>
            <div class="mt-4 inline-flex items-center bg-white/20 backdrop-blur-sm px-4 py-1.5 rounded-full text-sm font-bold border border-white/10">
                <i class="fa-solid fa-graduation-cap mr-2 text-yellow-300"></i>
                Classe : {{ student.classe.name }}
            </div>
        </div>
        <div class="hidden md:block text-8xl opacity-20">
            <i class="fa-solid fa-book-open"></i>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    
    <!-- Left Col: Today's Schedule (Mini) -->
    <div class="lg:col-span-2 space-y-8">
        <div>
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-slate-800 flex items-center">
                    <i class="fa-solid fa-clock text-blue-500 mr-2"></i> Aujourd'hui
                </h2>
                <span class="text-sm font-bold text-slate-400 bg-white px-3 py-1 rounded-lg shadow-sm">
                    {{ "now"|date('l d F Y') }}
                </span>
            </div>

            {% if todaysClasses is empty %}
                <div class="bg-white rounded-2xl p-8 text-center shadow-sm border border-slate-100">
                    <div class="text-green-500 text-5xl mb-3"><i class="fa-solid fa-mug-hot"></i></div>
                    <h3 class="font-bold text-slate-700 text-lg">Pas de cours aujourd'hui !</h3>
                    <p class="text-slate-400">Profite de ta journÃ©e de repos.</p>
                </div>
            {% else %}
                <div class="space-y-4">
                    {% for schedule in todaysClasses %}
                        <div class="bg-white p-5 rounded-2xl shadow-sm border-l-8 border-campus-yellow flex items-center transition-transform hover:-translate-y-1 hover:shadow-md">
                            <div class="mr-6 text-center min-w-[80px]">
                                <div class="text-slate-800 font-extrabold text-lg">{{ schedule.startTime|date('H:i') }}</div>
                                <div class="text-slate-400 text-xs font-bold uppercase">Ã  {{ schedule.endTime|date('H:i') }}</div>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-bold text-lg text-slate-800">{{ schedule.subject.name }}</h3>
                                <div class="flex items-center text-sm text-slate-500 mt-1">
                                    <span class="flex items-center mr-4">
                                        <i class="fa-solid fa-user-tie text-blue-400 mr-1.5"></i> {{ schedule.teacher.fullName }}
                                    </span>
                                    <span class="flex items-center">
                                        <i class="fa-solid fa-door-open text-yellow-500 mr-1.5"></i> Salle {{ schedule.room }}
                                    </span>
                                </div>
                            </div>
                            <div class="hidden sm:block">
                                <span class="bg-blue-50 text-blue-600 px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wide">
                                    {{ schedule.courseType }}
                                </span>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Right Col: Quick Stats & Grades -->
    <div class="space-y-8">
        <!-- Profile Summary -->
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 text-center">
            <div class="w-24 h-24 rounded-full bg-slate-100 mx-auto mb-4 overflow-hidden border-4 border-white shadow-lg">
                {% if student.profilePicture %}
                    <img src="{{ asset(student.profilePicture) }}" class="w-full h-full object-cover">
                {% else %}
                    <div class="w-full h-full flex items-center justify-center text-3xl text-slate-300">
                        <i class="fa-solid fa-user"></i>
                    </div>
                {% endif %}
            </div>
            <h3 class="font-bold text-slate-800 text-lg">{{ student.fullName }}</h3>
            <p class="text-slate-400 text-sm mb-4">{{ student.cne }}</p>
            <a href="{{ path('student_schedule_index') }}" class="block w-full bg-slate-50 text-slate-600 py-2 rounded-xl font-bold hover:bg-campus-yellow hover:text-slate-900 transition-colors">
                Voir mon emploi du temps
            </a>
        </div>

        <!-- Recent Grades -->
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
            <h3 class="font-bold text-slate-800 mb-4 flex items-center">
                <i class="fa-solid fa-star text-yellow-400 mr-2"></i> DerniÃ¨res Notes
            </h3>
            <div class="space-y-3">
                {% for grade in recentGrades %}
                    <div class="flex justify-between items-center border-b border-slate-50 pb-2 last:border-0 last:pb-0">
                        <div>
                            <div class="font-bold text-slate-700 text-sm">{{ grade.subject.name }}</div>
                            <div class="text-xs text-slate-400">{{ grade.type|capitalize }}</div>
                        </div>
                        <div class="font-mono font-bold text-lg {{ grade.value >= 10 ? 'text-blue-600' : 'text-red-500' }}">
                            {{ grade.value }}<span class="text-xs text-slate-400">/20</span>
                        </div>
                    </div>
                {% else %}
                    <p class="text-sm text-slate-400 italic">Aucune note pour le moment.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}